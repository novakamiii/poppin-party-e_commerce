<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poppin Party</title>
    <link rel="icon" th:href="@{/img/logowhite.png}" type="image/png">
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
</head>
<style>
    .form-footer {
        font-size: 0.2em;
        color: #333;
        margin-top: 20px;
    }

    /* Style the date picker */
    input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(0.5);
        padding: 4px;
        cursor: pointer;
    }
</style>

<body>

    <!--Header-->
    <header class="sticky-header">
        <div class="header-inner-login">
            <div class="logo">
                <a th:href="@{'/home'}">
                    <img th:src="@{/img/logowhite.png}" alt="logo" id="logo">
                </a>
            </div>
        </div>
    </header>
    <!--End of Header-->
    <main>
        <div class="page-wrapper">
            <div class="signup-container">
                <p>SIGN UP</p>
                <form autocomplete="off" th:object="${user}" th:action="@{/register}" method="post">
                    <div class="form-columns">
                        <!-- Left Column (7 items) -->
                        <div class="form-column">
                            <input type="text" id="email" th:field="*{email}" placeholder="E-Mail" required>
                            <input type="text" th:field="*{name}" placeholder="First Name" required>
                            <select th:field="*{gender}" class="form-select" required>
                                <option value="" disabled selected>Select your gender</option>
                                <option th:each="genderOpt : ${genders}" th:value="${genderOpt}" th:text="${genderOpt}">
                                </option>
                            </select>
                            <input type="date" th:field="*{birthDate}" class="form-control" required>
                            <input type="text" id="username" th:field="*{username}" placeholder="Username" required>
                            <input type="tel" th:field="*{phone}" id="phone" placeholder="Phone Number"
                                pattern="^(09|\+639)\d{9}$" required>

                            <!-- Address Selects -->
                            <select class="form-select" id="region" required>
                                <option value="">Select Region</option>
                            </select>
                            <span id="emailError" class="error-text"></span>
                            <span id="usernameError" class="error-text"></span>
                            <span class="error-text" id="phoneError"></span>
                        </div>

                        <!-- Right Column (7 items) -->
                        <div class="form-column">
                            <select class="form-select" id="province" required disabled>
                                <option value="">Select Province</option>
                            </select>
                            <select class="form-select" id="city" required disabled>
                                <option value="">Select City/Municipality</option>
                            </select>
                            <select class="form-select" id="barangay" required disabled>
                                <option value="">Select Barangay</option>
                            </select>

                            <input type="text" id="lotNumber" placeholder="Block/Lot Number/Subdivision" required>
                            <input type="text" id="street" placeholder="Street Name" required>
                            <!-- Hidden Combined Address -->
                            <input type="hidden" th:field="*{address}" id="fullAddress">

                            <!-- Passwords -->
                            <input type="password" th:field="*{password}" id="newPassword" placeholder="Password"
                                required>
                            <input type="password" id="confirmPassword" name="confpassword"
                                placeholder="Confirm Password" required oninput="validatePassword()">
                            <span id="passwordError"></span>
                        </div>
                    </div>


                    <div class="form-button-wrapper">
                        <button type="submit">SIGN UP</button>
                    </div>
                    <h2>
                        Already have an Account? <a th:href="@{/login}">Log In</a>
                    </h2>
                </form>
            </div>
        </div>
    </main>




    <img th:src="@{${user.imagePath}}" onerror="this.src='/img/default-profile.png'" hidden /> <!--PAssword Section-->
    <style>
        .password-match {
            color: green;
        }

        .password-mismatch {
            color: red;
        }

        .error-text {
            color: red;
        }
    </style>


    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <img th:src="@{/img/logowhite.png}" alt="Poppin Party Logo">
                <p>POPPIN PARTY</p>
                <p>CELEBRATION NEEDS</p>
            </div>
            <div class="footer-section">
                <h3>CUSTOMER SERVICE</h3>
                <ul>
                    <li>HELP CENTRE</li>
                    <li>CONTACT US</li>
                    <li>RETURN AND REFUND</li>
                    <li>POPPIN' GUARANTEE</li>
                    <li>FREE SHIPPING</li>
                    <li>PAYMENT METHODS</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>ABOUT POPPIN' PARTY</h3>
                <ul>
                    <li>ABOUT US</li>
                    <li>PRIVACY POLICY</li>
                    <li>POPPIN' DEALS</li>
                    <li>MEDIA CONTACT</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>PAYMENT</h3>
                <ul>
                    <li>GCASH</li>
                    <li>PAYPAL</li>
                    <li>CASHAPP</li>
                    <li>VISA</li>
                    <li>MASTERCARD</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>LOGISTICS</h3>
                <ul>
                    <li>GOGO EXPRESS</li>
                    <li>NINJAVAN</li>
                    <li>UPS</li>
                    <li>FEDEX</li>
                    <li>LBC</li>
                    <li>DHL</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>FOLLOW US</h3>
                <ul>
                    <li>FACEBOOK</li>
                    <li>INSTAGRAM</li>
                    <li>X</li>
                    <li>TIKTOK</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            © 2025 POPPIN PARTY CELEBRATION NEEDS™. ALL RIGHTS RESERVED
        </div>
    </footer>


</body>
<script th:src="@{/js/script.js}"></script>
<script th:src="@{/js/psgcAPI.js}"></script>
<script>
    function validatePassword() {
        const password = document.getElementById('newPassword').value;
        const confPassword = document.getElementById('confirmPassword').value;
        const errorElement = document.getElementById('passwordError');

        if (confPassword.length === 0) {
            errorElement.textContent = "";
            errorElement.className = "form-text";
        } else if (password.length < 5) {
            errorElement.textContent = "";
            errorElement.className = "form-text";
            errorElement.textContent = "Password must be at least 5 characters!";
            errorElement.style.color = "red";
            errorElement.className = "form-text password must be atleast 5 characters!";
            return false;
        } else if (password !== confPassword) {
            errorElement.textContent = "Passwords do not match!";
            errorElement.className = "form-text password-mismatch";
            return false;
        } else {
            errorElement.textContent = "Passwords match!";
            errorElement.style.color = "green";
            errorElement.className = "form-text password-match";
            return true;
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Prevent future birthdates
        var dateInput = document.querySelector('input[type="date"]');
        if (dateInput) {
            dateInput.addEventListener('change', function () {
                const selectedDate = new Date(this.value);
                if (selectedDate > new Date()) {
                    alert("Birthdate cannot be in the future!");
                    this.value = '';
                }
            });
        }

        // Live validation as user types
        var confirmPasswordInput = document.getElementById('confirmPassword');
        if (confirmPasswordInput) {
            confirmPasswordInput.addEventListener('input', validatePassword);
        }
        var newPasswordInput = document.getElementById('newPassword');
        if (newPasswordInput) {
            newPasswordInput.addEventListener('input', validatePassword);
        }

        // Prevent form submit if password doesn't match or is too short
        var registerForm = document.querySelector('form[th\\:action="@{/register}"]');
        if (registerForm) {
            registerForm.addEventListener('submit', function (e) {
                if (!validatePassword()) {
                    e.preventDefault();
                    alert("Please make sure passwords match and are at least 5 characters!");
                }
            });
        }
    });
</script>

</html>